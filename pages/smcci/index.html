<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GRADIO PORTAL</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<style>
  /* Reset */
  * { margin:0; padding:0; box-sizing:border-box; }
  html, body { height:100%; font-family:Arial,sans-serif; overflow-x:hidden; color:#fff; }

  .bg-video, .bg-fallback {
    position: fixed;
    top: 0; 
    left: 0;
    width: 100%; 
    height: 100%;
    object-fit: cover;
    z-index: -1;
  }

  .hidden { display: none; }

  .fade-in { animation: fadeIn 1s ease forwards; }

  @keyframes fadeIn {
    from { opacity: 0; }
    to   { opacity: 1; }
  }

  /* Desktop warning */
  @media (min-width:1024px){
    #desktop-block { display:flex !important; }
    body>*:not(#desktop-block) { display:none !important; }
  }

  /* Apps Grid */
  .apps-grid { 
    display:grid; 
    grid-template-columns:repeat(3,1fr); 
    gap:1.5rem; 
    justify-items:center; 
    margin-top:1rem;
  }
  .app-icon { width:64px; height:64px; border-radius:20%; }
  .app-label { font-size:0.75rem; margin-top:0.5rem; }

  /* Footer */
  .footer-nav img { transition:transform 0.3s; }
  .footer-nav img:hover { transform:scale(1.1); }

  /* Swiper pagination */
  .swiper-pagination { justify-content:center; display:flex; }
</style>
</head>
<body class="text-white">

<!-- Fallback Background Image -->
<img id="bgImage" src="assets/background/space-fallback.jpg" alt="Background" class="bg-fallback">

<!-- Background Video -->
<video id="bgVideo" autoplay muted loop playsinline class="bg-video hidden" aria-hidden="true">
  <source src="assets/background/space.gif" type="video/mp4">
</video>

<!-- Desktop Warning -->
<div id="desktop-block" class="hidden fixed inset-0 bg-black text-white flex items-center justify-center text-center z-50">
  <div>
    <h1 class="text-3xl font-bold mb-4">📱 Mobile Only</h1>
    <p class="text-lg">This portal is only available on mobile devices.<br>Please use your phone to continue.</p>
  </div>
</div>

<!-- Header with Logo -->
<header class="flex justify-center mt-4">
  <img src="assets/icons/logo.png" alt="Logo" class="h-16 w-auto">
</header>

<!-- Intro Video (YouTube Iframe) -->
<div class="flex justify-center mt-6 px-4">
  <iframe 
    class="w-full max-w-md rounded-lg shadow-lg aspect-video"
    src="https://www.youtube.com/embed/DLpKgKSWHlk?autoplay=1&mute=1&loop=1&playlist=DLpKgKSWHlk" 
    title="YouTube video player" 
    frameborder="0" 
    allow="autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
    referrerpolicy="strict-origin-when-cross-origin" 
    allowfullscreen>
  </iframe>
</div>

<!-- Apps Section -->
<div class="apps-section mb-12 mt-8">
  <div class="swiper">
    <div class="swiper-wrapper" id="apps-wrapper">
      <!-- JS will populate slides -->
    </div>
    <div class="swiper-pagination mt-4"></div>
  </div>
</div>

<!-- Footer Navigation -->
<div class="flex justify-center items-center mb-6 mt-12 footer-nav">
  <div class="relative flex items-center justify-between w-full max-w-4xl px-6 bg-[#1c1c1c] rounded-full shadow-lg">
    
    <!-- Earth -->
    <a href="earth.html" target="_blank">
      <img src="assets/GIF/earth.gif" alt="Earth" class="w-16 h-16 cursor-pointer ml-4">
    </a>
    
    <!-- Home -->
    <a href="home.html" target="_blank">
      <img id="floatingBtn" src="assets/icons/Home.png" alt="Apps" class="w-24 h-24 cursor-pointer -mt-8 z-10">
    </a>
    
    <!-- Mars -->
    <a href="https://vtqit.github.io/GradioCantilan/home.html" target="_blank">
      <img src="assets/GIF/Mars.gif" alt="Mars" class="w-16 h-16 cursor-pointer mr-4">
    </a>
    
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  // Service Worker
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("sw.js")
        .then(reg => console.log("✅ Service Worker registered:", reg.scope))
        .catch(err => console.error("❌ Service Worker registration failed:", err));
    });
  }

  // Background Video Swap
  const bgVideo = document.getElementById("bgVideo");
  const bgImage = document.getElementById("bgImage");

  bgVideo.addEventListener("canplaythrough", () => {
    bgImage.style.display = "none";          // hide fallback
    bgVideo.classList.remove("hidden");      // show video
    bgVideo.classList.add("fade-in");        // smooth transition
    bgVideo.play();                          // ensure playback starts
  });

  // Load Apps
  async function loadApps() {
    try {
      const res = await fetch("assets/data/apps.json");
      const apps = await res.json();

      const appsWrapper = document.getElementById("apps-wrapper");
      appsWrapper.innerHTML = "";

      // Split into chunks of 6 apps per page
      for (let i = 0; i < apps.length; i += 6) {
        const pageApps = apps.slice(i, i + 6);

        // Create slide
        const slide = document.createElement("div");
        slide.className = "swiper-slide";

        // Create grid
        const grid = document.createElement("div");
        grid.className = "apps-grid";

        // Add apps to grid
        pageApps.forEach(app => {
          const appDiv = document.createElement("div");
          appDiv.className = "text-center";
          appDiv.innerHTML = `
            <a href="${app.link}" target="_blank">
              <img src="${app.icon}" class="app-icon">
            </a>
            <p class="app-label">${app.name}</p>
          `;
          grid.appendChild(appDiv);
        });

        slide.appendChild(grid);
        appsWrapper.appendChild(slide);
      }

      // Initialize Swiper
      new Swiper(".swiper", {
        slidesPerView: 1,
        spaceBetween: 10,
        centeredSlides: true,
        loop: false,
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
          dynamicBullets: true,
        },
      });

    } catch (err) {
      console.error("Error loading apps:", err);
    }
  }

  window.addEventListener("DOMContentLoaded", loadApps);
</script>
</body>
</html>

